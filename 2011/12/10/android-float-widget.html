<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>基于Android的浮动组件，可以用于应用中的新功能展示等等。 | 飞雪无情的博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="前言在开发Android应用时,加新功能是必不可少的，我们加入了新的功能，有的一看界面就可以看出来，但是有的新功能就比较隐蔽，也就是用户很难知道你添加了这个新功能，这个时候就需要用户在打开我们的应用时给出一些提示，说明我们在哪里添加了新功能，点击哪里可以看到这个新功能。这时我们第一时间想到的可能是Toast，因为它用法简单，又不影响用户操作，但是它有个缺点，就是不能明确的指示是哪里添加了新功能，除">
<meta property="og:type" content="article">
<meta property="og:title" content="基于Android的浮动组件，可以用于应用中的新功能展示等等。">
<meta property="og:url" content="http://www.flysnow.org/2011/12/10/android-float-widget.html">
<meta property="og:site_name" content="飞雪无情的博客">
<meta property="og:description" content="前言在开发Android应用时,加新功能是必不可少的，我们加入了新的功能，有的一看界面就可以看出来，但是有的新功能就比较隐蔽，也就是用户很难知道你添加了这个新功能，这个时候就需要用户在打开我们的应用时给出一些提示，说明我们在哪里添加了新功能，点击哪里可以看到这个新功能。这时我们第一时间想到的可能是Toast，因为它用法简单，又不影响用户操作，但是它有个缺点，就是不能明确的指示是哪里添加了新功能，除">
<meta property="og:image" content="http://hi.csdn.net/attachment/201112/10/0_13234942045Irb.gif">
<meta property="og:image" content="http://hi.csdn.net/attachment/201112/10/0_1323508315BC94.gif">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="基于Android的浮动组件，可以用于应用中的新功能展示等等。">
<meta name="twitter:description" content="前言在开发Android应用时,加新功能是必不可少的，我们加入了新的功能，有的一看界面就可以看出来，但是有的新功能就比较隐蔽，也就是用户很难知道你添加了这个新功能，这个时候就需要用户在打开我们的应用时给出一些提示，说明我们在哪里添加了新功能，点击哪里可以看到这个新功能。这时我们第一时间想到的可能是Toast，因为它用法简单，又不影响用户操作，但是它有个缺点，就是不能明确的指示是哪里添加了新功能，除">
  
    <link rel="alternative" href="/atom.xml" title="飞雪无情的博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-44570956-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">飞雪无情的博客</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">专注于Android、Java、移动互联网、项目管理、软件架构</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">首页</a>
        
          <a class="main-nav-link" href="/archives">归档</a>
        
          <a class="main-nav-link" href="/about">关于</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="q" value="site:http://www.flysnow.org"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-android-float-widget" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2011/12/10/android-float-widget.html" class="article-date">
  <time datetime="2011-12-10T01:12:00.000Z" itemprop="datePublished">2011-12-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Android/">Android</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      基于Android的浮动组件，可以用于应用中的新功能展示等等。
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="前言">前言</h2><p>在开发Android应用时,加新功能是必不可少的，我们加入了新的功能，有的一看界面就可以看出来，但是有的新功能就比较隐蔽，也就是用户很难知道你添加了这个新功能，这个时候就需要用户在打开我们的应用时给出一些提示，说明我们在哪里添加了新功能，点击哪里可以看到这个新功能。这时我们第一时间想到的可能是Toast，因为它用法简单，又不影响用户操作，但是它有个缺点，就是不能明确的指示是哪里添加了新功能，除非你用文字描述出来。为此，我基于Toast编写了一个小组件FloatTextToast（下面遇到的这个名字代替我写的这个组件），他和Toast的用法一样简单，并且弥补了Toast的缺点，也更显得更好看。</p>
<h2 id="效果图">效果图</h2><p><img src="http://hi.csdn.net/attachment/201112/10/0_13234942045Irb.gif" alt=""></p>
<h2 id="你可以学到">你可以学到</h2><ol>
<li>Toast的基本用法</li>
</ol>
<ol>
<li>Android的消息机制，如何创建自己的消息队列</li>
</ol>
<ol>
<li>怎样在Activity启动时获取一个View的width、height、top、left等属性</li>
</ol>
<h2 id="基本思路">基本思路</h2><ol>
<li>首先你要有一个处理好的9 PNG的图片，用于自适应文字显示，关于9 PNG处理可以参考Android Doc</li>
</ol>
<ol>
<li>要显示在哪个View的下面，就要知道这个目标View的位置</li>
</ol>
<ol>
<li>把要显示的文本放在一个TextView里，使用Toast的setView方法设置Toast要显示的View</li>
</ol>
<ol>
<li>根据得到的位置，最后就是使用Toast的setGravity方法把要显示的内容放到正确的位置显示出来即可。</li>
</ol>
<p>总的来说首先就是要知道目标View，根据targetView计算出要显示提示的位置，然后根据位置使用Toast把提示的文本显示出来。但是这里有几个难点，下面就一一解决</p>
<h2 id="Activity加载完成时获取targetVIew的宽高和位置属性">Activity加载完成时获取targetVIew的宽高和位置属性</h2><p>我们加入了新的功能提示，自然会在用户打开这个界面的时候就提示，但是在UI没有渲染完成绑定倒Window上的时候，是不能获取倒targetView的width、height和position的，那么我们怎么才能知道targetView的这些属性呢？Activity的onAttachedToWindow回调方法是不能用的，况且它是在API 5加上的，以前的API中并没有。不过我们还有一种方法，那就是在显示提示的时候获取targetView的属性，如果获取不到（为0）就一直获取，直到获取到为止，这其实是一个轮询。为了达到这一目的，我们在开发者调用FloatTextToast.show()的时候使用Android的Message机制轮询获取一个targetView的属性，如果获取到，就会显示提示文字了。在此之前先看下FloatTextToast构造函数，可以对它有个大概的了解，防止后面的代码中出现的成员变量不认识。</p>
<pre><code><span class="function"><span class="keyword">private</span> <span class="title">FloatTextToast</span><span class="params">(Context context,View targetView)</span> </span>{
        <span class="keyword">this</span>.mTargetView = targetView;
        <span class="keyword">this</span>.mContext= context;
        mToast=<span class="keyword">new</span> Toast(mContext);
        mContentView=<span class="keyword">new</span> TextView(mContext);
        mContentView.setBackgroundResource(R.drawable.float_text_toast_bg);
        mContentView.setTextColor(Color.BLACK);
        mContentView.setTextSize(TypedValue.COMPLEX_UNIT_DIP,<span class="number">16</span>);
        mToast.setView(mContentView);

        <span class="comment">//初始化一个Handler线程</span>
        mHandlerThread=<span class="keyword">new</span> HandlerThread(<span class="string">"FloatTextToast"</span>);
        mHandlerThread.start();
        mHandler=<span class="keyword">new</span> FloatTextToastHandler(mHandlerThread.getLooper());
    }
</code></pre><h2 id="自定义自己的消息循环机制">自定义自己的消息循环机制</h2><p>要想在一个自定义的组件中使用Message机制，一定要有自己的Looper机制，我们不能使用Activity的Looper，因为主Looper可能会有其他的Message需要处理，这就会导致我们的show方法会延迟调用，这样效果就不好了，所以要有一个专门的Looper来处理此Message。要声明自己的Looper，就需要HandlerThread这个类的配合了，这可是个好东西，使用它你会很容易的创建一个自己的线程用于处理你Message。使用方法很简单，如下代码：</p>
<pre><code><span class="comment">//初始化一个Handler线程</span>
        mHandlerThread=<span class="keyword">new</span> HandlerThread(<span class="string">"FloatTextToast"</span>);
        mHandlerThread.start();
        mHandler=<span class="keyword">new</span> FloatTextToastHandler(mHandlerThread.getLooper());
</code></pre><p>这样就声明了一个HandlerThread并且让它运行，运行之后我们就可以获取一个属于该Thread的Looper，然后把Message发送给这个Looper，那么这个线程就可以处理你发送的消息了。。看看我们的自定义Handler</p>
<pre><code><span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">FloatTextToastHandler</span> <span class="keyword"><span class="keyword">extends</span></span> <span class="title">Handler</span>{</span>

        public <span class="type">FloatTextToastHandler</span>(<span class="type">Looper</span> looper) {
            <span class="keyword">super</span>(looper);
        }

        <span class="annotation">@Override</span>
        public void handleMessage(<span class="type">Message</span> msg) {
            switch(msg.what){
            <span class="keyword">case</span> <span class="type">WHAT_SHOW</span>:
                showInHandler();
            }
        }

    }
</code></pre><p>它需要传递一个Looper作为构造参数声明，意思就是使用这个Looper处理我发send的Message的意思。上面的代码</p>
<pre><code>mHandler=<span class="keyword">new</span> <span class="type">FloatTextToastHandler</span>(mHandlerThread.getLooper<span class="literal">()</span>);
</code></pre><p>正是我们使用自己开启的线程处理我们的Message的意思。下面看下我们的showInHandler()方法是怎么处理的。</p>
<pre><code>/**在<span class="type">Handler</span>调用的show方法，主要为了等待{@link #mTargetView}的位置*/
    <span class="keyword">private</span> void showInHandler<span class="literal">()</span>{
        <span class="built_in">int</span><span class="literal">[]</span> targetPos=getTargetViewPos<span class="literal">()</span>;
        <span class="keyword">if</span>(targetPos[<span class="number">0</span>]==<span class="number">0</span>&amp;&amp;targetPos[<span class="number">1</span>]==<span class="number">0</span>){
            mHandler.sendEmptyMessageDelayed(<span class="type">WHAT_SHOW</span>, <span class="number">100</span>);
        }<span class="keyword">else</span>{
            final <span class="type">Rect</span> contentPos=getContentViewPos(targetPos);
            mToast.setGravity(<span class="type">Gravity</span>.<span class="type">LEFT</span>|<span class="type">Gravity</span>.<span class="type">TOP</span>, contentPos.left, contentPos.top);
            mToast.show<span class="literal">()</span>;
        }
    }
</code></pre><p>该方法其实就是在获取targetVIew的位置，如果获取不到，则向自定义的Looper里发送一个Message重新调用该函数，如果得到了位置，那么就调用Toast的setGravity方法设置好要显示文本的位置，然后显示即可。</p>
<h2 id="获取要显示文本的位置">获取要显示文本的位置</h2><p>要获取显示的位置，就要知道targetVIew的位置以及它的宽、高，这样就能计算要显示文本的位置了。View组件都有一个函数，可以把自己在Window里的坐标转换为一个数组。</p>
<pre><code><span class="keyword">private</span> <span class="built_in">int</span><span class="literal">[]</span> getTargetViewPos<span class="literal">()</span>{
        final <span class="built_in">int</span><span class="literal">[]</span> targetPos=<span class="keyword">new</span> <span class="built_in">int</span>[<span class="number">2</span>];
        mTargetView.getLocationInWindow(targetPos);
        return targetPos;
    }
</code></pre><p>这样，就返回了targetView的xy坐标了。光有targetView的坐标还不够，还要有contentView最终要显示的位置。</p>
<pre><code><span class="comment">/**
     * 计算获取浮动文本显示的位置，把浮动文本放在targetView的中心处
     * @return 一个包含top和left的Rect
     */</span>
    <span class="keyword">private</span>  Rect getContentViewPos(<span class="built_in">int</span>[] targetPos){
        <span class="keyword">final</span> Rect windowVisibleRect=<span class="keyword">new</span> Rect();
        <span class="keyword">final</span> View targetView=mTargetView;
        <span class="keyword">final</span> TextView contentView=mContentView;
        <span class="comment">//状态栏高度</span>
        targetView.getWindowVisibleDisplayFrame(windowVisibleRect);
        <span class="built_in">int</span> statusBarHeight=windowVisibleRect.top;

        <span class="comment">//背景图那个三角箭头的位置</span>
        <span class="keyword">final</span> TextPaint textPaint=contentView.getPaint();
        <span class="built_in">int</span> contentW=(<span class="built_in">int</span>)textPaint.measureText((<span class="keyword">String</span>)contentView.getText());
        <span class="built_in">int</span> arrowPos=(<span class="built_in">int</span>)(contentW*(<span class="number">30.0</span>/<span class="number">160</span>));

        <span class="keyword">final</span> Rect <span class="built_in">rect</span> = <span class="keyword">new</span> Rect();
        <span class="built_in">rect</span>.left = targetPos[<span class="number">0</span>]+targetView.getWidth()/<span class="number">2</span>-arrowPos;
        <span class="built_in">rect</span>.top = targetPos[<span class="number">1</span>]-statusBarHeight + targetView.getHeight();
        <span class="keyword">return</span> <span class="built_in">rect</span>;
    }
</code></pre><p>这个函数的功能就是让文本显示在targetView的下方的横向中间的位置，也就是文本的背景尖角三角要指向targetView横向中间的位置，这样才好看些。为了这个才需要使用Paint测量文本的宽度，所以这也是该组件的一个缺陷，不能显示String格式之外的字符，比如SpannableString。</p>
<h2 id="完整的组件代码">完整的组件代码</h2><p>上面是对组件代码的拆分讲解，是为了说明我们当时实现这个组件的想法以及步骤，下面就整体把代码列出来，明了的看一下。</p>
<pre><code><span class="javadoc">/**
 * 浮动的文本显示。根据一个提供的View，可以把文本显示到该View的下面.
 * 可以设置显示的时间，多了该时间后自动消失。目前只支持纯文本{@link String}类型的显示
 * 因为要计算显示文本的宽度。
 *<span class="javadoctag"> @author</span> michael_li(飞雪无情)
 *<span class="javadoctag"> @since</span> 2011-12-10 下午04:57:36
 */</span>
<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FloatTextToast</span> </span>{
    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> LENGTH_LONG=Toast.LENGTH_LONG;
    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> LENGTH_SHORT=Toast.LENGTH_SHORT;
    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> WHAT_SHOW=<span class="number">1</span>;

    <span class="keyword">private</span> Context mContext;
    <span class="keyword">private</span> View mTargetView;
    <span class="keyword">private</span> Toast mToast;
    <span class="keyword">private</span>  TextView mContentView;

    <span class="keyword">private</span> HandlerThread mHandlerThread;
    <span class="keyword">private</span> FloatTextToastHandler mHandler;
    <span class="function"><span class="keyword">private</span> <span class="title">FloatTextToast</span><span class="params">(Context context,View targetView)</span> </span>{
        <span class="keyword">this</span>.mTargetView = targetView;
        <span class="keyword">this</span>.mContext= context;
        mToast=<span class="keyword">new</span> Toast(mContext);
        mContentView=<span class="keyword">new</span> TextView(mContext);
        mContentView.setBackgroundResource(R.drawable.float_text_toast_bg);
        mContentView.setTextColor(Color.BLACK);
        mContentView.setTextSize(TypedValue.COMPLEX_UNIT_DIP,<span class="number">16</span>);
        mToast.setView(mContentView);

        <span class="comment">//初始化一个Handler线程</span>
        mHandlerThread=<span class="keyword">new</span> HandlerThread(<span class="string">"FloatTextToast"</span>);
        mHandlerThread.start();
        mHandler=<span class="keyword">new</span> FloatTextToastHandler(mHandlerThread.getLooper());
    }
    <span class="javadoc">/**
     * 生成一个FloatTextToast
     *<span class="javadoctag"> @param</span> context Activity 上下文
     *<span class="javadoctag"> @param</span> targetView  目标View，浮动文本要显示在哪个View下面
     *<span class="javadoctag"> @param</span> text 要显示的文本
     *<span class="javadoctag"> @param</span> duration 浮动文本显示的时间 {@link #LENGTH_LONG} {@link #LENGTH_SHORT}
     *<span class="javadoctag"> @return</span> 一个FloatTextToast，可以调用{@link #show()}显示
     */</span>
    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> FloatTextToast <span class="title">makeText</span><span class="params">(Context context,View targetView, String text, <span class="keyword">int</span> duration)</span> </span>{
        <span class="keyword">final</span> FloatTextToast floatToast=<span class="keyword">new</span> FloatTextToast(context,targetView);
        <span class="keyword">final</span> TextView contentView=floatToast.mContentView;
        contentView.setText(text);
        floatToast.mToast.setDuration(duration);
        <span class="keyword">return</span> floatToast;
    }
    <span class="javadoc">/**
     * 显示浮动文本
     */</span>
    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span></span>{
        mHandler.sendEmptyMessage(WHAT_SHOW);
    }
    <span class="javadoc">/**在Handler调用的show方法，主要为了等待{@link #mTargetView}的位置*/</span>
    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">showInHandler</span><span class="params">()</span></span>{
        <span class="keyword">int</span>[] targetPos=getTargetViewPos();
        <span class="keyword">if</span>(targetPos[<span class="number">0</span>]==<span class="number">0</span>&amp;&amp;targetPos[<span class="number">1</span>]==<span class="number">0</span>){
            mHandler.sendEmptyMessageDelayed(WHAT_SHOW, <span class="number">100</span>);
        }<span class="keyword">else</span>{
            <span class="keyword">final</span> Rect contentPos=getContentViewPos(targetPos);
            mToast.setGravity(Gravity.LEFT|Gravity.TOP, contentPos.left, contentPos.top);
            mToast.show();
        }
    }
    <span class="keyword">private</span> <span class="keyword">int</span>[] getTargetViewPos(){
        <span class="keyword">final</span> <span class="keyword">int</span>[] targetPos=<span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">2</span>];
        mTargetView.getLocationInWindow(targetPos);
        <span class="keyword">return</span> targetPos;
    }
    <span class="javadoc">/**
     * 计算获取浮动文本显示的位置，把浮动文本放在targetView的中心处
     *<span class="javadoctag"> @return</span> 一个包含top和left的Rect
     */</span>
    <span class="function"><span class="keyword">private</span>  Rect <span class="title">getContentViewPos</span><span class="params">(<span class="keyword">int</span>[] targetPos)</span></span>{
        <span class="keyword">final</span> Rect windowVisibleRect=<span class="keyword">new</span> Rect();
        <span class="keyword">final</span> View targetView=mTargetView;
        <span class="keyword">final</span> TextView contentView=mContentView;
        <span class="comment">//状态栏高度</span>
        targetView.getWindowVisibleDisplayFrame(windowVisibleRect);
        <span class="keyword">int</span> statusBarHeight=windowVisibleRect.top;

        <span class="comment">//背景图那个三角箭头的位置</span>
        <span class="keyword">final</span> TextPaint textPaint=contentView.getPaint();
        <span class="keyword">int</span> contentW=(<span class="keyword">int</span>)textPaint.measureText((String)contentView.getText());
        <span class="keyword">int</span> arrowPos=(<span class="keyword">int</span>)(contentW*(<span class="number">30.0</span>/<span class="number">160</span>));

        <span class="keyword">final</span> Rect rect = <span class="keyword">new</span> Rect();
        rect.left = targetPos[<span class="number">0</span>]+targetView.getWidth()/<span class="number">2</span>-arrowPos;
        rect.top = targetPos[<span class="number">1</span>]-statusBarHeight + targetView.getHeight();
        <span class="keyword">return</span> rect;
    }
    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">FloatTextToastHandler</span> <span class="keyword">extends</span> <span class="title">Handler</span></span>{

        <span class="function"><span class="keyword">public</span> <span class="title">FloatTextToastHandler</span><span class="params">(Looper looper)</span> </span>{
            <span class="keyword">super</span>(looper);
        }

        <span class="annotation">@Override</span>
        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleMessage</span><span class="params">(Message msg)</span> </span>{
            <span class="keyword">switch</span>(msg.what){
            <span class="keyword">case</span> WHAT_SHOW:
                showInHandler();
            }
        }

    }
}
</code></pre><p>此组件和Toast的实现方法一样，所以上手不难，只需使用makeText静态方法生成一个即可</p>
<pre><code>FloatTextToast.<span class="function"><span class="title">makeText</span><span class="params">(Context context, View targetView, String text, int duration)</span></span>.<span class="function"><span class="title">show</span><span class="params">()</span></span>
</code></pre><p>就这么简单，传进去几个参数，show出即可，和Toast一样好用。</p>
<h2 id="小结">小结</h2><p>这里主要是通过类之间的组合编写一个一个FloatTextToast组件，便于在应用中提示一些信息，不光局限于新功能的提示，还有其他的点击查看个人信息等等，就如上面的效果图一样。这里主要的难点就在于Activity启动获取targetView的状态，这里采用了不受影响的自定义的消息机制，能及时的获取targetView的状态。这里也采用的Toast的队列机制，这样就能够更好的一个个的提示，让用户看完一个再显示另外一个，不至于一下子全显示出来，而用户没有时间看。这里还采用了Paint用于测量文本的真实宽度，所以也有了一些缺陷，如果哪位有更好的方法，也可以留言告知我，不胜感激。</p>
<p><img src="http://hi.csdn.net/attachment/201112/10/0_1323508315BC94.gif" alt=""></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.flysnow.org/2011/12/10/android-float-widget.html" data-id="ci7g9uvly002vz1n1u4lkf6y2" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2013/01/05/android-viewgroup-setdescendantfocusability.html" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Android ViewGroup.setDescendantFocusability函数
        
      </div>
    </a>
  
  
    <a href="/2011/11/15/android-4-0-api-arrange.html" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">提取出的最新Android4.0 API 源代码</div>
    </a>
  
</nav>

  
</article>

  
  <section id="comments">
    <!-- 多说评论框 start -->
    <div class="ds-thread" data-thread-key="post-android-float-widget" data-title="基于Android的浮动组件，可以用于应用中的新功能展示等等。" data-url="http://www.flysnow.org/2011/12/10/android-float-widget.html"></div>
    <!-- 多说评论框 end -->
    <!-- 多说公共JS代码 start (一个网页只需插入一次) -->
    <script type="text/javascript">
    var duoshuoQuery = {short_name:'flysnow'};
      (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0] 
         || document.getElementsByTagName('body')[0]).appendChild(ds);
      })();
      </script>
    <!-- 多说公共JS代码 end -->
  </section>
  
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Android/">Android</a><span class="category-list-count">37</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Hexo/">Hexo</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/软件开发/">软件开发</a><span class="category-list-count">2</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/API/">API</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Android/">Android</a><span class="tag-list-count">37</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Apache/">Apache</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Email/">Email</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Github/">Github</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hexo/">Hexo</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Http/">Http</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HttpClitent/">HttpClitent</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Intent/">Intent</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/">Linux</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Nginx/">Nginx</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PHP/">PHP</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ubuntu/">Ubuntu</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Widget/">Widget</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/goagent/">goagent</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gradle/">gradle</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/代理/">代理</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/开源/">开源</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/敏捷/">敏捷</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数据库/">数据库</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/翻墙/">翻墙</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/翻译/">翻译</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/软件工程/">软件工程</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/软件开发/">软件开发</a><span class="tag-list-count">2</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/API/" style="font-size: 13.33px;">API</a><a href="/tags/Android/" style="font-size: 20px;">Android</a><a href="/tags/Apache/" style="font-size: 10px;">Apache</a><a href="/tags/Email/" style="font-size: 10px;">Email</a><a href="/tags/Github/" style="font-size: 10px;">Github</a><a href="/tags/Hexo/" style="font-size: 10px;">Hexo</a><a href="/tags/Http/" style="font-size: 10px;">Http</a><a href="/tags/HttpClitent/" style="font-size: 10px;">HttpClitent</a><a href="/tags/Intent/" style="font-size: 13.33px;">Intent</a><a href="/tags/Linux/" style="font-size: 15px;">Linux</a><a href="/tags/Nginx/" style="font-size: 10px;">Nginx</a><a href="/tags/PHP/" style="font-size: 10px;">PHP</a><a href="/tags/Ubuntu/" style="font-size: 18.33px;">Ubuntu</a><a href="/tags/Widget/" style="font-size: 16.67px;">Widget</a><a href="/tags/goagent/" style="font-size: 10px;">goagent</a><a href="/tags/gradle/" style="font-size: 10px;">gradle</a><a href="/tags/代理/" style="font-size: 10px;">代理</a><a href="/tags/开源/" style="font-size: 10px;">开源</a><a href="/tags/敏捷/" style="font-size: 10px;">敏捷</a><a href="/tags/数据库/" style="font-size: 10px;">数据库</a><a href="/tags/翻墙/" style="font-size: 10px;">翻墙</a><a href="/tags/翻译/" style="font-size: 10px;">翻译</a><a href="/tags/软件工程/" style="font-size: 10px;">软件工程</a><a href="/tags/软件开发/" style="font-size: 11.67px;">软件开发</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/03/">三月 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/01/">一月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/07/">七月 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/03/">三月 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/02/">二月 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/12/">十二月 2013</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/11/">十一月 2013</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/10/">十月 2013</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/03/">三月 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/02/">二月 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/01/">一月 2013</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/12/">十二月 2011</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/11/">十一月 2011</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/10/">十月 2011</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/07/">七月 2011</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/05/">五月 2011</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/03/">三月 2011</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/02/">二月 2011</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/01/">一月 2011</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/11/">十一月 2010</a><span class="archive-list-count">7</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2015/03/19/android-process-application-init-databases-problem.html">Android多进程的数据库访问问题</a>
          </li>
        
          <li>
            <a href="/2015/03/10/github-page-with-hexo.html">使用Hexo在Github上搭建自己的博客</a>
          </li>
        
          <li>
            <a href="/2015/01/12/android-gradle-plugin-translate-done.html">Android Gradle插件中文指南</a>
          </li>
        
          <li>
            <a href="/2014/07/13/effective-programming-more-than-writing-code.html">高效能程序员的修炼</a>
          </li>
        
          <li>
            <a href="/2014/03/22/android-avd-not-launcher.html">android新建大分辨率模拟器不能启动的问题</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2015 飞雪无情<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">首页</a>
  
    <a href="/archives" class="mobile-nav-link">归档</a>
  
    <a href="/about" class="mobile-nav-link">关于</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>


<script src="/js/script.js" type="text/javascript"></script>

  </div>
</body>
</html>